## Menu

--- View the menu items table

SELECT*
FROM dbo.menu_items

---- Find the number of items in this menu
SELECT count(*)
FROM dbo.menu_items



---- What are the least and most expensive item

SELECT *
FROM dbo.menu_items
order by price


SELECT *
FROM dbo.menu_items
order by price DESC

---- How many italian dishes are on the menu

SELECT count(*) as [Number of Italian Dishes]
FROM dbo.menu_items
where category = 'Italian'


---- What are the least and most expensive italian dishes are on the menu

SELECT * 
FROM dbo.menu_items
where category = 'Italian'
order by price



SELECT * 
FROM dbo.menu_items
where category = 'Italian'
order by price Desc



---- How many dishes are in each category

SELECT [category] , count(menu_item_id) as [num_dishes]
from dbo.menu_items
group by category



---- what is the avg dish price within each category

SELECT [category] , Avg(price) as [Avg_Price]
from dbo.menu_items
group by category
  



# Orders

SELECT *
FROM dbo.order_details


---- What is the date range of the table


SELECT min(order_date), max(order_date)
FROM dbo.order_details



---- How many orders were made within the date range


SELECT count (distinct order_id)
from order_details



---- How many items were ordered within the date range


SELECT count(*)
FROM dbo.order_details





---- Which order had the most number of items


SELECT [order_id] , count(item_id) as [num_items]
from dbo.order_details
group by order_id
order by num_items desc




----- How many orders had more than 12 items


Select count(*) num_orders from
(SELECT [order_id] , count(item_id) as [num_items]
from dbo.order_details
group by order_id
having count(item_id) >12) as num_orders


## Menu & Orders


Combine the menu items and order details tables into  a singel table

SELECT *
FROM order_details od
LEFT JOIN menu_items mi
ON od.item_id = mi.menu_item_id; 

----- What were the least and most order items & what category were they in

SELECT item_name , category , count (order_details_id) as num_purchases
FROM order_details od
LEFT JOIN menu_items mi
ON od.item_id = mi.menu_item_id
GROUP BY item_name, category
order by num_purchases desc



----- What were the top 5 orders that spend the most mony

SELECT top 5 order_id,sum(price) as total_spend
FROM order_details od
LEFT JOIN menu_items mi
ON od.item_id = mi.menu_item_id
group by order_id
order by total_spend desc


----- view the detail of the highest spend order & what insights can you gather from

SELECT category , count(item_id) as num_items,order_id
FROM order_details od
LEFT JOIN menu_items mi
ON od.item_id = mi.menu_item_id
where order_id in (440 , 2075 , 1957 ,2675)
group by category,order_id

